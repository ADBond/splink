# Cluster Evaluation

Graphs provide a natural way to think about linked data. Visualising linked data as a graph and employing graph metrics are powerful ways to evaluate linkage quality. Insights gained can be used to refine linking strategies, resulting in more accurate predictions.

Graph metrics can help determine a big-picture view of the quality of clusters generated by a Splink model. For example, the distribution of cluster sizes can reveal outliers, such as very large clusters, that may require closer examination.

Metrics can also help us to home in on problematic clusters, such as those containing inaccurate links. For example, the 'is bridge' metric (see below) can be a signaller of false positives.

Splink‚Äôs [Cluster Studio Dashboard]() empowers users to visualise individual clusters and interrogate the links between their member records. Applying metrics at the individual cluster level within the Dashboard is also useful; for example, for analysing large clusters containing many nodes where it can be impossible to spot spurious links by eye alone.
Should we be saying this if the metrics aren't available in the dashboard yet?

!!! note
    It is important to bear in mind that whilst graph metrics can be very useful for assessing linkage quality, they are rarely definitive, especially when taken in isolation. A more comprehensive picture can be built by considering various metrics in conjunction with one another.
    
    It is also important to consider metrics within the context of their distribution and the underlying dataset. For example: a cluster density (see below) of 0.4 might seem low but could actually be above average for the dataset in question; a cluster of size 80 might be suspiciously large for one dataset but not for another.

## Graphs 

For clarity, let us first define what we mean by a graph. A graph is a collection of points (nodes) connected by lines (edges).

[Include picture here]

In data linking, we refer to these collections of nodes as clusters, within which the nodes represent the entity to be linked (e.g. person or journey) and the edges represent a potential match.

[Include picture here]

Edges come with an associate Splink score (the probability of two records being a match). This makes graphs (clusters) produced by Splink so called weighted graphs, as each edge has a weight (Splink score).

Graphs can also be directed or undirected. Directed (undirected) graphs are those in which edges (do not) have an associated direction. For example, linking court cases/journeys.
Linking person records, where the ...

[insert image]

Impact of directed versus non-directed on the definitions below...

Other graph properties like loops etc
Loops when it comes to cross dataset linking and deduping...
Does this apply to all cases of data linking?

## Graph metrics

Graph metrics quantify the characteristics of a graph (a cluster). A simple example of a graph metric is cluster size, which is the number of nodes in a cluster.

For data linking with Splink, it is useful to sort graph metrics into three categories: cluster metrics, node metrics and edge metrics. These are defined below together with examples of each and their application to linked data. The examples given are of all metrics currently available to compute in Splink.
What about availability to use in the dashboard?

### :fontawesome-solid-circle-nodes: Cluster metrics

Cluster metrics refer to the characteristics of a cluster as a whole, rather than the individual nodes and edges it contains.

#### Example: size

Cluster size is defined as the number of nodes a cluster contains.

Big clusters, max size
Small clusters, min size
Modal size
What constitute 'big' is dataset 

#### Example: density

The density of a cluster is given by the number of edges a cluster contains divided by the maximum possible number of edges.

[insert formula]

Density ranges from 0 to 1. A density of 1 means that all nodes are connected to all other nodes in a cluster.

[picture: edges vs max possible edges]

When examining linked data, a high density (close to 1) is generally considered good as it means there are many edges in support of the records in a cluster being linked.
A low density score could indicate links being missed - why aren't more links being formed between records? - data quality? Blokcing rules too tight?, which could happen, for example, if blocking rules are too tight or the clustering threshold is too high.

Explain the relationship between density and cluster size and it's consequences.
Stratified sampling in cluster studio.

#### Example: cluster centralisation

TBC

### ‚ö´Ô∏è Node metrics

Node metrics quantify the properties of the nodes within clusters.

#### Example: node degree

A node degree is the number of edges (links) connected to a node.

within clusters or across clusters?

Nodes with high node degree are more connected; they support many links.

and can be signalers of more reliable links.

However, high node degree also places more pressure on a node to be a legitimate member of a cluster as its removal could dramatically change the cluster‚Äôs structure. Therefore... 

Low node degree 

### üîó Edge metrics

Edge metrics quantify the properties of edges within a cluster. 

#### Example: 'is bridge'

An edge is classified as a bridge if its removal breaks a cluster into two smaller clusters.

[insert picture]

Bridges can be signalers of false positives in linked data, especially when joining two highly connected clusters, so...

Where to acknowledge the slight difference between our definition and the literature/directed etc?

## How to evaluate cluster quality

- Trying to answer the question of 'what does good look like?'
- General points about what to expect - 'unexpectedly sparse' - how do we know what is reasonable before making the clusters?
-- Previous model runs, labelled data, a gold standard
-- Build up intuition - iterative process of feedback which builds up expectations

This is not intended to be a complete guide to...
best case scenario - labelled data (gold standard, synthetic)
Linked/deduplicated similar datasets before
Knowledge of datasets to give an idea of what's expected
No idea but can build up expectations

Reiterate that metrics don't give the whole answer.

## ‚ö° How to compute graph metrics with Splink

To enable users to calculate a variety of graph metrics for their linked data, Splink provides the `compute_graph_metrics()` method.

